<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="PulseVibe"><meta property="og:type" content="article"><meta name=robots content="index,follow,noarchive"><meta property="og:image" content="//img/home-bg-jeep.jpg"><meta property="twitter:image" content="//img/home-bg-jeep.jpg"><meta name=title content="How to Write a Batch Script on Windows"><meta property="og:title" content="How to Write a Batch Script on Windows"><meta property="twitter:title" content="How to Write a Batch Script on Windows"><meta name=description content="Do you know how to use the Command Prompt? If you do, you can write a batch file. In its simplest form, a batch file (or batch script) is a list of several commands that are executed when you double-click the file. Batch files go all the way back to DOS, but still work on"><meta property="og:description" content="Do you know how to use the Command Prompt? If you do, you can write a batch file. In its simplest form, a batch file (or batch script) is a list of several commands that are executed when you double-click the file. Batch files go all the way back to DOS, but still work on"><meta property="twitter:description" content="Do you know how to use the Command Prompt? If you do, you can write a batch file. In its simplest form, a batch file (or batch script) is a list of several commands that are executed when you double-click the file. Batch files go all the way back to DOS, but still work on"><meta property="twitter:card" content="summary"><meta name=keyword content><link rel="shortcut icon" href=./img/favicon.ico><title>How to Write a Batch Script on Windows |</title><link rel=canonical href=./how-to-write-a-batch-script-on-windows.html><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/bootstrap.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/zanshang.css><link href=https://cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@5.15.1/css/all.css rel=stylesheet type=text/css><script src=https://assets.cdnweb.info/hugo/cleanwhite/js/jquery.min.js></script>
<script src=https://assets.cdnweb.info/hugo/cleanwhite/js/bootstrap.min.js></script>
<script src=https://assets.cdnweb.info/hugo/cleanwhite/js/hux-blog.min.js></script></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=./>PulseVibe</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=./categories/blog>blog</a></li><li><a href=./sitemap.xml>Sitemap</a></li><li><a href=./index.xml>RSS</a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/img/home-bg-jeep.jpg)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags></div><h1>How to Write a Batch Script on Windows</h1><h2 class=subheading></h2><span class=meta>Posted by
Reinaldo Massengill
on
Monday, August 26, 2024</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><h3>Quick Links</h3><ul class=table-content-level-1><li><a href=#>How to Make a Basic Batch File</a></li></ul><ul class=table-content-level-1><li><a href=#>Writing a More Complex Batch File</a></li></ul><h3 class="title icon i-list">Key Takeaways</h3><ul><li>Batch files are a list of commands executed when double-clicked. They work on modern versions of Windows and are created using a plain text editor.</li><li>Simple batch files can be created by typing commands line by line. Adding comments and hiding commands with "ECHO OFF" can improve readability.</li><li>Batch files can be used for more complex tasks, such as saving command outputs to a text file or running non-interactively to perform multiple tasks. They can also include conditional statements for greater control.</li></ul><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Do you know how to use the Command Prompt? If you do, you can write a batch file. In its simplest form, a batch file (or batch script) is a list of several commands that are executed when you double-click the file. Batch files go all the way back to <a href=#>DOS</a>, but still work on modern versions of Windows.</p><h2 id=how-to-make-a-basic-batch-file>How to Make a Basic Batch File</h2><p>A batch file is simply a text file saved with the .bat file extension. You can write one using Notepad or a more advanced <a href=#>plain text editor</a> like <a href=#>Notepad++</a> or <a href=# rel="noopener noreferrer">Visual Studio Code (VSCode)</a>, but <strong>don't</strong> use a word processor like Microsoft Word. Word processors usually insert additional stuff related to formatting that will prevent your batch script from executing correctly.</p><p><a href=#>PowerShell scripts</a> and <a href=#>Bash scripts</a> may be more powerful, but batch files can still be plenty useful if you need to <a href=#>run basic Windows commands</a>. They still work on both Windows 10 and Windows 11, and will for the foreseeable future.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Let's create a simple batch file. First, open Notepad. Type the following lines into it:</p><pre><code class="hljs php"><span class=hljs-keyword>ECHO</span> OFF<br><span class=hljs-keyword>ECHO</span> Hello World<br>PAUSE</code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2016/07/img_578be635b9e29.png><p>Next, save the file by clicking File > Save. Give it any name you like, but replace the default .txt file extension with the .bat extension.</p><p>For example, you might want to name it <code>hello_world.bat</code> .</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2016/07/img_578be6055207f.png> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>You now have a batch file with the .bat <a href=#>file extension</a>. Double-click it to run it. This particular batch file sets ECHO off (which cleans up the output by hiding the commands from being printed at the prompt, prints the text "Hello World" to the screen, and then waits for you to press a key before it ends.</p><p>If you didn't add <code>PAUSE</code> to the file, the batch file would simply run its commands and then automatically close. In this case, it would print "Hello World" to the window and then immediately close the Command Prompt window. When you want to quickly run commands without seeing the output, you can omit this. If you're running several commands, you could place the <code>PAUSE</code> command in between them.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2016/07/img_578be5d53572b.png> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h2 id=writing-a-more-complex-batch-file>Writing a More Complex Batch File</h2><p>It's fundamentally simple to create a batch file. The only thing you need to change is what you type into Notepad. To run several commands, you type each one on its own line and the batch file will run each one in order.</p><p>For example, let's say we want to write a batch file that runs several <a href=#>network diagnostic commands</a>. We might want to run <code>ipconfig /all</code> to view network information, <code>ping google.com</code> to see if Google's servers are responding, and <code>tracert google.com</code> to run a traceroute to google.com and see if there are any problems on the way.</p><p>In the most basic form, we could simply place all those commands in a batch file, one after the other, like so:</p><pre><code class="hljs xml">ipconfig /all<br><span class=hljs-selector-tag>ping</span>&nbsp;<span class=hljs-selector-tag>google</span><span class=hljs-selector-class>.com</span><br><span class=hljs-selector-tag>tracert</span>&nbsp;<span class=hljs-selector-tag>google</span><span class=hljs-selector-class>.com</span><br>PAUSE</code> </pre><p>When we run this file, we'd just see the output of each command right after the other. But this isn't necessarily the ideal way to write a batch file.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2016/07/img_578be74370da5.png> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>For example, you might want to add comment lines. Any line that begins with a <code>::</code> is a comment line and won't be executed. That makes them a useful way to explain what's happening in the file for anyone you might give it to — or for your future self, who might forget why you put a certain command in there.</p><p>You might also want to add the "ECHO OFF" command to the beginning of the file. This is typically added to the start of most batch files. When you do this, the commands themselves won't be printed to the Command Prompt, but the results will be. For example, you'll see the network connection details but not the "ipconfig /all" line. Most people don't care to see the commands, so this can clean up the output.</p><p>So here's what that might look like:</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><pre><code class="hljs xml">:: This batch file checks for network connection problems.<br><span class=hljs-keyword>ECHO</span> OFF<br>:: View network connection details<br>ipconfig /all<br>:: <span class=hljs-keyword>Check</span>&nbsp;<span class=hljs-keyword>if</span> Google.com <span class=hljs-keyword>is</span> reachable<br><span class=hljs-selector-tag>ping</span>&nbsp;<span class=hljs-selector-tag>google</span><span class=hljs-selector-class>.com</span><br>:: Run a traceroute to <span class=hljs-keyword>check</span> the route <span class=hljs-keyword>to</span> Google.com<br><span class=hljs-selector-tag>tracert</span>&nbsp;<span class=hljs-selector-tag>google</span><span class=hljs-selector-class>.com</span><br>PAUSE</code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2016/07/img_578be72a75d94.png><p>There are other directions you could go with a batch file like this. For example, you might want to have your batch script run the above commands and then dump the output to a text file you can view later. To do so, you'd use the <code>>></code> operator after each command to append its output to the text file. As we're going to read the output from the text file anyway, we can omit the <code>PAUSE</code> command.</p><pre><code class="hljs xml">:: This batch file checks for network connection problems<br>:: <span class=hljs-selector-tag>and</span>&nbsp;<span class=hljs-selector-tag>saves</span>&nbsp;<span class=hljs-selector-tag>the</span>&nbsp;<span class=hljs-selector-tag>output</span>&nbsp;<span class=hljs-selector-tag>to</span>&nbsp;<span class=hljs-selector-tag>a</span>&nbsp;<span class=hljs-selector-class>.txt</span>&nbsp;<span class=hljs-selector-tag>file</span>.<br><span class=hljs-keyword>ECHO</span> OFF<br>:: View network connection details<br>ipconfig /all &gt;&gt; results.txt<br>:: <span class=hljs-keyword>Check</span>&nbsp;<span class=hljs-keyword>if</span> Google.com <span class=hljs-keyword>is</span> reachable<br><span class=hljs-selector-tag>ping</span>&nbsp;<span class=hljs-selector-tag>google</span><span class=hljs-selector-class>.com</span> &gt;&gt; <span class=hljs-selector-tag>results</span><span class=hljs-selector-class>.txt</span><br>:: Run a traceroute to <span class=hljs-keyword>check</span> the route <span class=hljs-keyword>to</span> Google.com<br><span class=hljs-selector-tag>tracert</span>&nbsp;<span class=hljs-selector-tag>google</span><span class=hljs-selector-class>.com</span> &gt;&gt; <span class=hljs-selector-tag>results</span><span class=hljs-selector-class>.txt</span></code> </pre><p>After you run the above script, you'd find a file named results.txt in the same folder as the batch file with the output of the commands. The Command Prompt window will automatically close once the batch file is done running.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2016/07/img_578be5aa97406.png> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>The example we're using above relies on actually printing information to the Command Prompt so the user can read it. However, many batch files are designed to be run non-interactively. For example, you could have a batch file that deletes multiple files or directories whenever you double-click it. You'd just need to use the <code>del</code> command to delete files or the <code>deltree</code> command to delete directories. Remember, you're just using the same commands you'd run in a Command Prompt window.</p><p>Fundamentally, that's the point of most batch files — just running a few commands one after another. However, batch files can actually be significantly more complex than this. For example, you can use "IF" statements along with the "<a href=#>GOTO</a>" command to check the value of something and then skip to different lines depending on the result. This is more like writing an actual small program than a quick and dirty script. That's one reason why .bat files are sometimes called "batch programs." If you want to do something more complex, you'll find plenty of guides to doing specific things with batch programming online. But now, you know the basics of how to throw a simple one together.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmivp6x7qbvWraagnZWge6S7zGhpb2thbIRwtM6wZK2nXay%2FqsDEZphmmpGpsKl50pypoqikYryvedaipZ2np6h8</p><hr><ul class=pager><li class=previous><a href=./gina-kirschenheiter-says-shannon-crossed-some-boundaries.html data-toggle=tooltip data-placement=top title="Kate Winslet says Ozempic 'sounds terrible' as she opens up about her eating disorder battle and rev">&larr;
Previous Post</a></li><li class=next><a href=./dua-lipa-red-carpet-photos-grammys-2024.html data-toggle=tooltip data-placement=top title="Dua Lipa Embodies Rock 'n' Roll Glamour in a Chainmail Gown at the 2024 Grammys">Next
Post &rarr;</a></li></ul></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5><a href=./tags/>FEATURED TAGS</a></h5><div class=tags></div></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"></ul><p class="copyright text-muted">Copyright &copy; PulseVibe 2024<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function loadAsync(i,t){var n=document,s="script",e=n.createElement(s),o=n.getElementsByTagName(s)[0];e.src=i,t&&e.addEventListener("load",function(e){t(null,e)},!1),o.parentNode.insertBefore(e,o)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,r=$(_containerSelector),a=r.find("h1,h2,h3,h4,h5,h6");return $(e).html(''),a.each(function(){n=$(this).prop("tagName").toLowerCase(),i="#"+$(this).prop("id"),s=$(this).text(),t=$('<a href="'+i+'" rel="nofollow">'+s+"</a>"),o=$('<li class="'+n+'_nav"></li>').append(t),$(e).append(o)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("https://assets.cdnweb.info/hugo/cleanwhite/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/banner.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>